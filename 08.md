
---

### اسلاید 2: تابع هش (چکیده‌ساز/ درهم‌ساز)
تابع هش، یک تابع ریاضی است که داده‌های با طول دلخواه را به یک مقدار خروجی با طول ثابت تبدیل می‌کند. به این مقدار، چکیده یا "هش" گفته می‌شود. ویژگی‌های کلیدی:
- **Compress**: پیام‌های طولانی به یک خلاصه فشرده تبدیل می‌شوند.
- **Digest/Fingerprint**: خروجی منحصربه‌فردی برای هر ورودی تولید می‌کند.

**مثال**: تابع SHA-256 یک پیام متنی مانند "hello" را به کد زیر تبدیل می‌کند:
```
2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824
```

---

### اسلاید 3: تابع یک‌طرفه (مقاومت پیش‌تصویر اول)
تابع هش باید به گونه‌ای باشد که از خروجی به ورودی اصلی بازگشت ممکن نباشد. این ویژگی به امنیت اطلاعات کمک می‌کند.

**مثال**: اگر \( h(x) = y \) باشد، نمی‌توان با دانستن \( y \)، به سادگی \( x \) را پیدا کرد. مثلاً هش "1234" در SHA-256 قابل بازگشت به متن اصلی نیست.

---

### اسلاید 4: مقاومت پیش‌تصویر دوم
یک تابع هش باید به گونه‌ای طراحی شود که با داشتن یک ورودی مشخص، نتوان ورودی دیگری یافت که همان هش را تولید کند.

**مثال**: برای یک هش مشخص، مثلاً:
```
2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824
```
نباید بتوان یک پیام دیگری غیر از "hello" یافت که همان هش را تولید کند.

---

### اسلاید 5 و 6: برخورد‌تاب
در این ویژگی، یافتن دو پیام متفاوت که هش یکسان تولید کنند، باید دشوار باشد.

**مثال**: برای پیام‌های "hello" و "world"، تابع SHA-256 خروجی‌های کاملاً متفاوتی تولید می‌کند. یافتن دو پیام با هش یکسان یک "برخورد" است و نباید به راحتی رخ دهد.

---

### اسلاید 7: برخورد‌تاب بودن و عصاره پیام
توابع هش برای خلاصه‌سازی داده‌ها استفاده می‌شوند و تغییرات کوچک در ورودی باید خروجی کاملاً متفاوتی تولید کند.

**مثال**: تغییر یک بیت در پیام "hello" به "Hello"، خروجی هش کاملاً متفاوتی تولید می‌کند.

---

### **برخوردتاب چیست؟**
برخوردتاب به این معناست که برای یک تابع هش \( h(x) \):
1. یافتن دو ورودی متفاوت \( x \) و \( x' \) که خروجی‌های یکسان \( h(x) = h(x') \) داشته باشند، باید بسیار دشوار باشد.
2. این ویژگی تضمین می‌کند که هش تولیدشده برای داده‌ها تقریباً منحصربه‌فرد باشد.

---

### **ویژگی‌های برخوردتاب**
#### **1. برخوردتاب ضعیف:**
- مهاجم نمی‌تواند برای یک ورودی مشخص \( x \)، یک ورودی دیگر \( x' \) پیدا کند که \( h(x) = h(x') \).
- در این حالت، مهاجم در انتخاب \( x \) دخالتی ندارد و فقط دنبال \( x' \) است.

#### **2. برخوردتاب قوی:**
- مهاجم می‌تواند \( x \) و \( x' \) را آزادانه انتخاب کند و هدف او یافتن دو ورودی است که خروجی یکسان داشته باشند.
- این ویژگی از برخوردتاب ضعیف سخت‌تر است، زیرا مهاجم اختیار بیشتری دارد.

---

### **اصول برخوردتاب**
#### **1. تعداد محدود خروجی‌ها:**
توابع هش دارای خروجی‌هایی با طول ثابت هستند. بنابراین، تعداد خروجی‌ها محدود است. برای مثال، در SHA-256، فضای خروجی‌ها \( 2^{256} \) مقدار ممکن دارد.

#### **2. اصل لانه‌کبوتری:**
طبق این اصل:
- اگر تعداد ورودی‌ها بیش از تعداد خروجی‌ها باشد، برخورد اجتناب‌ناپذیر است.
- در توابع هش، دامنه ورودی‌ها بسیار بیشتر از خروجی‌ها است، بنابراین احتمال برخورد وجود دارد. با این حال، یک تابع هش خوب این احتمال را به‌شدت کاهش می‌دهد.

---

### **مثال برای درک برخوردتاب**
فرض کنید تابع \( h(x) \) هش‌های 3 بیتی تولید می‌کند:
1. ورودی‌ها: \( \{A, B, C, D, E, F, G, H, I\} \)
2. خروجی‌ها: \( \{000, 001, 010, 011, 100, 101, 110, 111\} \)

اگر 9 ورودی داشته باشیم و فقط 8 خروجی ممکن باشد، طبق اصل لانه‌کبوتری، حتماً دو ورودی یک خروجی یکسان تولید خواهند کرد.

---

### **حمله‌ها به برخوردتاب**
#### **1. حمله روز تولد:**
- هدف این حمله یافتن دو ورودی متفاوت با خروجی هش یکسان است.
- با استفاده از اصول احتمالات، مهاجم می‌تواند با تعداد تلاش‌های کمتر از حد انتظار برخورد پیدا کند.
- برای یک تابع با خروجی \( n \) بیتی، احتمال یافتن برخورد پس از \( 2^{n/2} \) تلاش بالا می‌رود.

**مثال**: در SHA-256، برای یافتن برخورد احتمالی، به حدود \( 2^{128} \) تلاش نیاز است.

---

### **کاربردها و اهمیت برخوردتاب**
1. **امنیت امضاهای دیجیتال**:
   - هش پیام به عنوان نماینده آن استفاده می‌شود.
   - برخوردتاب تضمین می‌کند که مهاجم نمی‌تواند دو پیام با امضای دیجیتال یکسان بسازد.
   
2. **کنترل نسخه فایل‌ها**:
   - در سیستم‌هایی مانند Git، هش برای اطمینان از یکتا بودن داده‌ها استفاده می‌شود.

---

### **ویژگی‌های طراحی برای بهبود برخوردتاب**
1. استفاده از **خروجی با طول زیاد** (مانند SHA-512).
2. طراحی ساختارهای پیچیده‌تر مانند Merkle-Damgård که احتمال برخورد را کاهش می‌دهند.
3. جلوگیری از ساختارهای ضعیف که توسط حملات شناخته‌شده (مثل حمله MD5) قابل بهره‌برداری هستند.

---

### **تمرین**
1. اثبات کنید که هر تابع هش یک طرفه لزوماً برخوردتاب نیست.
   - راهنما: تابعی طراحی کنید که معکوس‌پذیر نباشد ولی دو ورودی یک خروجی یکسان بدهند.
   
2. تابعی بسازید که برخوردتاب باشد ولی یک‌طرفه نباشد.
   - راهنما: به جای پیچیدگی در محاسبات، بر یکتا بودن خروجی تمرکز کنید.

---

### اسلاید 8: ویژگی‌های تابع هش
توابع هش باید:
1. ورودی با طول دلخواه بپذیرند.
2. خروجی با طول ثابت تولید کنند.
3. یک‌طرفه باشند.
4. مقاومت پیش‌تصویر دوم و برخورد‌تاب داشته باشند.

---

### اسلاید 10: حمله روز تولد
این حمله بر اساس احتمال یافتن برخورد در تعداد زیادی ورودی است. اگر فضای خروجی هش کوچک باشد، احتمال برخورد بیشتر می‌شود.

**مثال**: در یک جمع 23 نفره، احتمال تولد دو نفر در یک روز، حدود 50% است.

---

### اسلاید 11: توابع هش رایج
توابع هش محبوب شامل MD5، SHA-1، SHA-256، و SHA-512 هستند. هر کدام دارای طول خروجی و کاربردهای مختلفی هستند.

---

### اسلاید 12: خانواده SHA-{1,2}
این خانواده توسط NSA طراحی شده و شامل انواع SHA-1، SHA-2 (224, 256, 384, 512 بیت) است.

---

### اسلاید 13 تا 17: ساختار SHA-512
این ساختار به کمک الگوریتم‌های بلوکی مانند Merkle-Damgård، پیام‌ها را به قالب‌های 1024 بیتی تقسیم کرده و هش را تولید می‌کند. در هر دور، از عملیات منطقی پیچیده استفاده می‌شود.

---

### اسلاید 18: پیاده‌سازی توابع هش
مثال کد پایتون برای محاسبه SHA-512:
```python
from Crypto.Hash import SHA512

h = SHA512.new()
h.update(b'Hello')
print(h.hexdigest())
```
---
