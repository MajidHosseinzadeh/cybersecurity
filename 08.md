
---

### اسلاید 2: تابع هش (چکیده‌ساز/ درهم‌ساز)
تابع هش، یک تابع ریاضی است که داده‌های با طول دلخواه را به یک مقدار خروجی با طول ثابت تبدیل می‌کند. به این مقدار، چکیده یا "هش" گفته می‌شود. ویژگی‌های کلیدی:
- **Compress**: پیام‌های طولانی به یک خلاصه فشرده تبدیل می‌شوند.
- **Digest/Fingerprint**: خروجی منحصربه‌فردی برای هر ورودی تولید می‌کند.

**مثال**: تابع SHA-256 یک پیام متنی مانند "hello" را به کد زیر تبدیل می‌کند:
```
2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824
```

---

### اسلاید 3: تابع یک‌طرفه (مقاومت پیش‌تصویر اول)
تابع هش باید به گونه‌ای باشد که از خروجی به ورودی اصلی بازگشت ممکن نباشد. این ویژگی به امنیت اطلاعات کمک می‌کند.

**مثال**: اگر \( h(x) = y \) باشد، نمی‌توان با دانستن \( y \)، به سادگی \( x \) را پیدا کرد. مثلاً هش "1234" در SHA-256 قابل بازگشت به متن اصلی نیست.

---

### اسلاید 4: مقاومت پیش‌تصویر دوم
یک تابع هش باید به گونه‌ای طراحی شود که با داشتن یک ورودی مشخص، نتوان ورودی دیگری یافت که همان هش را تولید کند.

**مثال**: برای یک هش مشخص، مثلاً:
```
2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824
```
نباید بتوان یک پیام دیگری غیر از "hello" یافت که همان هش را تولید کند.

---

### اسلاید 5 و 6: برخورد‌تاب
در این ویژگی، یافتن دو پیام متفاوت که هش یکسان تولید کنند، باید دشوار باشد.

**مثال**: برای پیام‌های "hello" و "world"، تابع SHA-256 خروجی‌های کاملاً متفاوتی تولید می‌کند. یافتن دو پیام با هش یکسان یک "برخورد" است و نباید به راحتی رخ دهد.

---

### اسلاید 7: برخورد‌تاب بودن و عصاره پیام
توابع هش برای خلاصه‌سازی داده‌ها استفاده می‌شوند و تغییرات کوچک در ورودی باید خروجی کاملاً متفاوتی تولید کند.

**مثال**: تغییر یک بیت در پیام "hello" به "Hello"، خروجی هش کاملاً متفاوتی تولید می‌کند.

---

### **برخوردتاب چیست؟**
برخوردتاب به این معناست که برای یک تابع هش \( h(x) \):
1. یافتن دو ورودی متفاوت \( x \) و \( x' \) که خروجی‌های یکسان \( h(x) = h(x') \) داشته باشند، باید بسیار دشوار باشد.
2. این ویژگی تضمین می‌کند که هش تولیدشده برای داده‌ها تقریباً منحصربه‌فرد باشد.

---

### **ویژگی‌های برخوردتاب**
#### **1. برخوردتاب ضعیف:**
- مهاجم نمی‌تواند برای یک ورودی مشخص \( x \)، یک ورودی دیگر \( x' \) پیدا کند که \( h(x) = h(x') \).
- در این حالت، مهاجم در انتخاب \( x \) دخالتی ندارد و فقط دنبال \( x' \) است.

#### **2. برخوردتاب قوی:**
- مهاجم می‌تواند \( x \) و \( x' \) را آزادانه انتخاب کند و هدف او یافتن دو ورودی است که خروجی یکسان داشته باشند.
- این ویژگی از برخوردتاب ضعیف سخت‌تر است، زیرا مهاجم اختیار بیشتری دارد.

---

### **اصول برخوردتاب**
#### **1. تعداد محدود خروجی‌ها:**
توابع هش دارای خروجی‌هایی با طول ثابت هستند. بنابراین، تعداد خروجی‌ها محدود است. برای مثال، در SHA-256، فضای خروجی‌ها \( 2^{256} \) مقدار ممکن دارد.

#### **2. اصل لانه‌کبوتری:**
طبق این اصل:
- اگر تعداد ورودی‌ها بیش از تعداد خروجی‌ها باشد، برخورد اجتناب‌ناپذیر است.
- در توابع هش، دامنه ورودی‌ها بسیار بیشتر از خروجی‌ها است، بنابراین احتمال برخورد وجود دارد. با این حال، یک تابع هش خوب این احتمال را به‌شدت کاهش می‌دهد.

---

### **مثال برای درک برخوردتاب**
فرض کنید تابع \( h(x) \) هش‌های 3 بیتی تولید می‌کند:
1. ورودی‌ها: \( \{A, B, C, D, E, F, G, H, I\} \)
2. خروجی‌ها: \( \{000, 001, 010, 011, 100, 101, 110, 111\} \)

اگر 9 ورودی داشته باشیم و فقط 8 خروجی ممکن باشد، طبق اصل لانه‌کبوتری، حتماً دو ورودی یک خروجی یکسان تولید خواهند کرد.

---

### **حمله‌ها به برخوردتاب**
#### **1. حمله روز تولد:**
- هدف این حمله یافتن دو ورودی متفاوت با خروجی هش یکسان است.
- با استفاده از اصول احتمالات، مهاجم می‌تواند با تعداد تلاش‌های کمتر از حد انتظار برخورد پیدا کند.
- برای یک تابع با خروجی \( n \) بیتی، احتمال یافتن برخورد پس از \( 2^{n/2} \) تلاش بالا می‌رود.

**مثال**: در SHA-256، برای یافتن برخورد احتمالی، به حدود \( 2^{128} \) تلاش نیاز است.

---

### **کاربردها و اهمیت برخوردتاب**
1. **امنیت امضاهای دیجیتال**:
   - هش پیام به عنوان نماینده آن استفاده می‌شود.
   - برخوردتاب تضمین می‌کند که مهاجم نمی‌تواند دو پیام با امضای دیجیتال یکسان بسازد.
   
2. **کنترل نسخه فایل‌ها**:
   - در سیستم‌هایی مانند Git، هش برای اطمینان از یکتا بودن داده‌ها استفاده می‌شود.

---

### **ویژگی‌های طراحی برای بهبود برخوردتاب**
1. استفاده از **خروجی با طول زیاد** (مانند SHA-512).
2. طراحی ساختارهای پیچیده‌تر مانند Merkle-Damgård که احتمال برخورد را کاهش می‌دهند.
3. جلوگیری از ساختارهای ضعیف که توسط حملات شناخته‌شده (مثل حمله MD5) قابل بهره‌برداری هستند.

---

### **تمرین**
1. اثبات کنید که هر تابع هش یک طرفه لزوماً برخوردتاب نیست.
   - راهنما: تابعی طراحی کنید که معکوس‌پذیر نباشد ولی دو ورودی یک خروجی یکسان بدهند.
   
2. تابعی بسازید که برخوردتاب باشد ولی یک‌طرفه نباشد.
   - راهنما: به جای پیچیدگی در محاسبات، بر یکتا بودن خروجی تمرکز کنید.

---

### اسلاید 8: ویژگی‌های تابع هش
توابع هش باید:
1. ورودی با طول دلخواه بپذیرند.
2. خروجی با طول ثابت تولید کنند.
3. یک‌طرفه باشند.
4. مقاومت پیش‌تصویر دوم و برخورد‌تاب داشته باشند.

---

### اسلاید 10: حمله روز تولد
این حمله بر اساس احتمال یافتن برخورد در تعداد زیادی ورودی است. اگر فضای خروجی هش کوچک باشد، احتمال برخورد بیشتر می‌شود.

**مثال**: در یک جمع 23 نفره، احتمال تولد دو نفر در یک روز، حدود 50% است.

---

### اسلاید 11: توابع هش رایج
توابع هش محبوب شامل MD5، SHA-1، SHA-256، و SHA-512 هستند. هر کدام دارای طول خروجی و کاربردهای مختلفی هستند.

---

### اسلاید 12: خانواده SHA-{1,2}
این خانواده توسط NSA طراحی شده و شامل انواع SHA-1، SHA-2 (224, 256, 384, 512 بیت) است.

---

### اسلاید 13 تا 17: ساختار SHA-512
این ساختار به کمک الگوریتم‌های بلوکی مانند Merkle-Damgård، پیام‌ها را به قالب‌های 1024 بیتی تقسیم کرده و هش را تولید می‌کند. در هر دور، از عملیات منطقی پیچیده استفاده می‌شود.

---

### **ساختارهای توابع هش**
توابع هش برای تولید هش‌های امن از داده‌ها به ساختارهای خاصی نیاز دارند. یکی از شناخته‌شده‌ترین این ساختارها، **ساختار مرکل-دامگارد** (Merkle-Damgård Construction) است که در توابع هش معروفی مثل SHA-1، SHA-256، و MD5 استفاده می‌شود.

---

### **ساختار مرکل-دامگارد**
ساختار مرکل-دامگارد، پایه و اساس بسیاری از توابع هش است. این ساختار یک پیام با طول دلخواه را به یک مقدار هش با طول ثابت تبدیل می‌کند.

#### **مراحل اصلی در مرکل-دامگارد**
1. **پد کردن پیام (Padding):**
   - پیام به‌گونه‌ای پد می‌شود که طول آن به یک مقدار خاص (معمولاً مضربی از طول بلوک) برسد.
   - یک بیت `1` به انتهای پیام اضافه می‌شود و سپس بیت‌های `0` اضافه می‌شوند.
   - در انتها، طول اصلی پیام (به صورت باینری) ضمیمه می‌شود.

   **مثال**: برای پیام `Hello`، اگر طول بلوک 512 بیت باشد، پیام ابتدا به 512 بیت با پدینگ کامل می‌شود.

2. **تقسیم پیام به بلوک‌های ثابت:**
   - پیام پد شده به بلوک‌های با طول ثابت (معمولاً 512 بیت یا 1024 بیت) تقسیم می‌شود.
   - هر بلوک به ترتیب پردازش می‌شود.

   **مثال**: اگر پیام 1024 بیت باشد و هر بلوک 512 بیت باشد، پیام به دو بلوک تقسیم می‌شود: \( M_1 \) و \( M_2 \).

3. **مقداردهی اولیه (Initialization Vector یا IV):**
   - یک مقدار ثابت (معمولاً از پیش تعریف شده) به عنوان مقدار اولیه برای هش استفاده می‌شود.

   **مثال**: در SHA-256، IV یک مقدار ثابت 256 بیتی است.

4. **پردازش هر بلوک:**
   - هر بلوک پیام به همراه مقدار هش قبلی وارد یک تابع فشرده‌سازی (Compression Function) می‌شود.
   - این تابع یک مقدار هش جدید تولید می‌کند که به بلوک بعدی انتقال می‌یابد.

   **مثال**: اگر \( H_0 \) مقدار اولیه باشد، خروجی بلوک اول \( H_1 \) و بلوک دوم \( H_2 \) است:
   \[
   H_1 = f(H_0, M_1), \quad H_2 = f(H_1, M_2)
   \]

5. **خروجی نهایی:**
   - پس از پردازش تمام بلوک‌ها، خروجی نهایی هش تولید می‌شود.

---

### **ویژگی‌های مرکل-دامگارد**
- **مقاومت در برابر برخورد:** اگر تابع فشرده‌سازی مقاوم باشد، کل ساختار نیز مقاوم است.
- **مقاومت پیش‌تصویر:** ساختار تضمین می‌کند که برگشت از خروجی نهایی به پیام اصلی سخت است.
- **وابستگی به کل پیام:** هر تغییر کوچک در پیام، خروجی نهایی را کاملاً تغییر می‌دهد.

---

### **مثال کاربردی: SHA-256**
تابع SHA-256 از ساختار مرکل-دامگارد استفاده می‌کند. جزئیات مراحل:

1. **پد کردن پیام:**
   پیام `Hello` به باینری تبدیل شده و به اندازه 512 بیت پد می‌شود.

2. **تقسیم به بلوک‌ها:**
   پیام پد شده به بلوک‌های 512 بیتی تقسیم می‌شود.

3. **مقدار اولیه (IV):**
   یک مقدار ثابت 256 بیتی به عنوان IV استفاده می‌شود.

4. **پردازش بلوک‌ها:**
   هر بلوک از طریق یک تابع فشرده‌سازی شامل عملیات XOR، AND، OR و شیفت‌های چرخشی پردازش می‌شود.

5. **خروجی نهایی:**
   هش نهایی 256 بیتی تولید می‌شود که خروجی SHA-256 برای پیام `Hello` است.

---

### **ساختار Sponge در SHA-3**
برخلاف مرکل-دامگارد، SHA-3 از **ساختار اسفنجی (Sponge Construction)** استفاده می‌کند. این ساختار مزایای خاصی دارد:

#### **مراحل اصلی در ساختار Sponge**
1. **فاز جذب (Absorbing):**
   - پیام به قطعات تقسیم می‌شود و هر قطعه در حالت داخلی (Internal State) ترکیب می‌شود.

2. **فاز فشرده‌سازی:**
   - حالت داخلی به طور مداوم با قطعات پیام آپدیت می‌شود.

3. **فاز انتشار (Squeezing):**
   - حالت داخلی برای تولید خروجی هش فشرده می‌شود.

**ویژگی‌ها:**
- انعطاف‌پذیری بیشتری نسبت به مرکل-دامگارد دارد.
- در برابر برخی حملات (مثل طول قابل تغییر پیام) مقاوم‌تر است.

---

### **مقایسه مرکل-دامگارد و Sponge**
| ویژگی                     | مرکل-دامگارد                  | Sponge                        |
|---------------------------|-------------------------------|-------------------------------|
| پیچیدگی طراحی            | ساده‌تر                      | پیچیده‌تر                    |
| انعطاف‌پذیری              | محدود                        | بسیار انعطاف‌پذیر            |
| مقاومت در برابر حملات      | نیاز به دقت بیشتر            | مقاوم‌تر                     |
| توابع هش مرتبط            | SHA-1, SHA-256, MD5          | SHA-3                        |

---

### **نتیجه‌گیری**
- **مرکل-دامگارد** برای توابع هش قدیمی‌تر مثل SHA-256 و MD5 استفاده می‌شود و به دلیل سادگی، بسیار محبوب است.
- **Sponge** در SHA-3 به کار رفته و برای کاربردهای مدرن و امن‌تر طراحی شده است.

---

### اسلاید 18: پیاده‌سازی توابع هش
مثال کد پایتون برای محاسبه SHA-512:
```python
from Crypto.Hash import SHA512

h = SHA512.new()
h.update(b'Hello')
print(h.hexdigest())
```
---
